# ToWow MVP 待商讨清单

> 团队协作决策点

---

## 一、SecondMe对接相关

**状态**：等SecondMe提供文档，不一定用MCP

| # | 问题 | 状态 |
|---|------|------|
| 1.1 | 接口格式 | 待SecondMe文档 |
| 1.2 | OAuth流程 | 待SecondMe文档 |
| 1.3 | 用户简介/记忆获取 | 待SecondMe文档 |

---

## 二、部署与基础设施

| # | 问题 | 决策 | 状态 |
|---|------|------|------|
| 2.1 | 服务器 | 单台服务器，阿里云 ecs.c7.2xlarge（8核16GB）或 c7.4xlarge（16核32GB） | ✅ 已确认 |
| 2.2 | OpenAgent部署 | 本地部署在同一台服务器，端口8700/8600 | ✅ 已确认 |
| 2.3 | PostgreSQL | 本地安装（不用云RDS），同一台服务器 | ✅ 已确认 |
| 2.4 | 域名和SSL | towow.net，SSL已有 | ✅ 已确认 |
| 2.5 | 现场网络 | 先不管，有应急措施 | ✅ 已确认 |
| 2.6 | Redis | **不需要**，OpenAgent内置状态管理 | ✅ 已确认 |

### 服务器配置详情（2026-01-21确认）

**架构简化原因**：
- OpenAgent是轻量级Python框架，内置Channel状态管理和消息存储
- 不需要Redis、不需要独立数据库实例
- 主要负载是LLM调用（走外部Claude API，不占本地资源）
- 演示只用一天，单机足够

**推荐配置**：
```
单台服务器（阿里云华北2-北京）
├── 实例：ecs.c7.2xlarge（8核16GB）或 ecs.c7.4xlarge（16核32GB）
├── 系统盘：100GB 高效云盘
├── 数据盘：100GB SSD（PostgreSQL + OpenAgent数据）
├── 带宽：10Mbps（按流量计费）
└── 预估月费用：1000-1500元
```

**服务端口分配**：
| 服务 | 端口 | 说明 |
|------|------|------|
| OpenAgent HTTP | 8700 | 网络发现、REST API |
| OpenAgent gRPC | 8600 | Agent连接（推荐） |
| OpenAgent MCP | 8800 | 可选 |
| ToWow API | 8000 | FastAPI后端 |
| PostgreSQL | 5432 | 本地数据库 |
| Nginx | 80/443 | 反向代理、SSL终止 |

**架构图**：
```
用户 → Nginx(443) → OpenAgent(8700/8600) + ToWow API(8000)
                            ↓
                    PostgreSQL(本地) + OpenAgent内置存储(./data)
                            ↓
                    外部：Claude API + SecondMe MCP
```

---

## 三、前端与展示

| # | 问题 | 决策 | 状态 |
|---|------|------|------|
| 3.1 | 展示需求 | 全程可视化：当前步骤、正在做什么、输出什么、摘要 | ✅ 已确认 |
| 3.2 | 用户端界面 | Web界面 | ✅ 已确认 |
| 3.3 | 流式输出UI | 打字效果 | ✅ 已确认 |
| 3.4 | 前端框架 | React或Vue，待定 | 待确认 |
| 3.5 | 移动端适配 | 需要，现场观众会用手机 | ✅ 已确认 |
| 3.6 | 前端负责人 | 单独拆分为模块任务 | 待分工 |

---

## 四、提示词与AI调优

| # | 问题 | 决策 | 状态 |
|---|------|------|------|
| 4.1 | 大模型 | Claude Sonnet | ✅ 已确认 |
| 4.2 | API Key | 自己配置 | ✅ 已确认 |
| 4.3 | 提示词负责人 | 待定（需要理解业务的人） | 待分工 |
| 4.4 | 版本管理 | 暂不需要 | ✅ 已确认 |

---

## 五、测试数据与演示

| # | 问题 | 状态 |
|---|------|------|
| 5.1 | 测试数据来源 | 暂时留空 |
| 5.2 | 演示场景脚本 | 暂时留空 |

---

## 六、异常处理与兜底

| # | 场景 | 处理策略 | 状态 |
|---|------|---------|------|
| 6.1 | 协商失败 | 告诉用户为什么失败、聊过谁、提过什么方案、给建议（补充上下文、问用户问题） | ✅ 已确认 |
| 6.2 | 递归超时 | 看实时状态，不预设固定时间 | ✅ 已确认 |
| 6.3 | LLM调用失败 | 重试，无降级 | ✅ 已确认 |
| 6.4 | 没有合适agent | **不返回失败！** 告诉用户为什么没有、现场有什么、提供次级/妥协方案 | ✅ 已确认 |

**核心原则**：有方案总比没方案好，尽量不给用户返回失败

---

## 七、团队分工

| # | 任务模块 | 负责人 | 备注 |
|---|---------|--------|------|
| 7.1 | OpenAgent部署与配置 | 用户 | 有问题可联系创始人 |
| 7.2 | ToWow后端开发 | 待定 | |
| 7.3 | SecondMe对接 | 待定 | 等SecondMe文档 |
| 7.4 | 前端开发 | 待定 | 单独模块 |
| 7.5 | 提示词设计与调优 | 待定 | 核心工作 |
| 7.6 | 测试 | 待定 | |

---

**文档版本**: v1.1
**更新时间**: 2026-01-21
**状态**: 部分已确认，待团队补充
