# A1 — HDC 编码策略验证

## 为什么做这件事

通爻网络中，Agent 的存在形式就是 HDC 超向量。共振检测——判断一个需求信号是否与一个 Agent "对味"——依赖超向量之间的汉明距离。编码质量直接决定了共振检测的准确率。

当前架构设计（Section 6.3.4）确定了三步编码流程：文本 → 嵌入向量 → SimHash → 二进制超向量。但**具体的编码策略**尚未通过实验验证——不同的编码方法会对最终效果有多大影响？这是需要量化回答的问题。

## 你要回答什么问题

**核心问题**：给定一段自然语言文本（如用户需求描述、Agent 能力描述），如何编码为 10,000 维二进制超向量，使得：
1. 语义相似的文本 → 汉明距离小（共振度高）
2. 语义不相关的文本 → 汉明距离接近 5,000（随机水平）
3. 编码过程足够快（< 10ms / 条）

**子问题**：
- SimHash vs MinHash vs Random Projection：哪种方法在"语义保持"上最好？
- 底层嵌入模型的选择：sentence-transformers（768 维）vs 更大的模型（1536 维）对最终共振检测质量的影响有多大？
- 维度数量（10,000 vs 5,000 vs 20,000）对区分度的影响？
- **bundle 操作**的质量：当把 5-10 个子向量 bundle 在一起（如技能1 + 技能2 + 经历1 + …），信息保留率如何？bundle 后还能准确共振吗？
- 中文 vs 英文文本的编码质量差异？（通爻是中文优先的系统）

## 我们提供什么

### 设计原则
- 原则 0.8：投影是基本操作 — `project(profile_data, lens)` 中的 `project` 就是这个编码
- 原则 0.2：复杂度目标 O(N+M) — 编码速度直接影响整体复杂度
- 原则 0.1：本质与实现分离 — 编码器可插拔，接口稳定

### 设计文档
- `docs/ARCHITECTURE_DESIGN.md` Section 6.3.4（HDC 三步编码流程）
- `docs/ARCHITECTURE_DESIGN.md` Section 6.3.5（画像生成）
- `docs/ARCHITECTURE_DESIGN.md` Section 6.3.6（共振检测流程）
- `docs/DESIGN_LOG_003_PROJECTION_AS_FUNCTION.md`（投影即函数的核心洞察）

### 工具和 Skill
- Arch Skill（`.claude/skills/arch/SKILL.md`）— 理解 HDC 在架构中的定位
- Dev Skill（`.claude/skills/towow-dev/SKILL.md`）— 工程实现指导

### 外部参考
- Kanerva, "Hyperdimensional Computing" (2009)
- Kleyko et al., "A Survey on Hyperdimensional Computing" (2023)
- Charikar, "Similarity Estimation Techniques from Rounding Algorithms" (SimHash, 2002)

### 已有决策
- 架构文档已选定 SimHash 作为 V1 默认方案，但需要实验验证

## 子任务分解

### A1.1 — 调研候选编码方法
**描述**：阅读相关论文和文档，梳理 SimHash、MinHash、Random Projection 及其他可能的编码方法。每个方法记录：原理、优劣、适用场景。
**依赖**：无（起始任务）
**交付**：候选方法清单（每个方法 1 页总结）

### A1.2 — 准备测试数据集
**描述**：构造或收集用于评估编码质量的测试数据集。需包含：语义相似对、语义不相关对、边界案例（部分相关）。中英文各至少 50 对。
**依赖**：A1.1（了解方法后才知道需要什么测试数据）
**交付**：测试数据集（CSV/JSON）+ 数据说明文档

### A1.3 — 实现编码函数
**描述**：为至少 3 种编码方法实现 Python 编码函数。接口统一：`encode(text: str) -> BinaryVector`。同时实现 bundle 操作。
**依赖**：A1.1（知道要实现哪些方法）
**交付**：Python 代码 + 单元测试

### A1.4 — 运行实验对比
**描述**：用测试数据集评估各编码方法。对比维度：语义保持率（相关对距离 vs 不相关对距离）、编码速度、维度数量影响、bundle 后信息保留率、中英文差异。
**依赖**：A1.2 + A1.3
**交付**：实验结果表格 + 可视化图表

### A1.5 — 撰写实验报告 + 推荐方案
**描述**：整合实验结果，撰写报告。给出推荐方案及理由。标注已知局限和后续改进方向。
**依赖**：A1.4
**交付**：实验报告（Jupyter Notebook 或 Markdown，3000-5000 字）+ 1 页推荐方案

## 做完了是什么样

1. **实验报告**（3000-5000 字）：完整的编码方法对比，有数据支撑
2. **推荐方案**（1 页）：清晰的"用什么方法、为什么"
3. **可复用代码**：编码函数 Python 实现 + 测试脚本，接口统一，可直接集成

**质量标准**：
- 至少对比 3 种编码方法
- 测试数据包含中英文各 50+ 对
- 有 bundle 操作的信息保留率数据
- 结论有量化支撑（不是"感觉 A 比 B 好"）

## 你必须遵守的

- 不需要关心通爻的业务逻辑——只关注"文本 → 超向量"的编码质量
- 编码器可插拔——统一接口，接受任何浮点嵌入向量作为输入
- 中文优先：测试数据必须包含中文文本
- HDC 是存在论承诺，不需要论证"要不要用 HDC"

## 你可以自己决定的

- 可以选择任何编码方法和嵌入模型
- 可以提出架构文档中没有的新方案
- 测试数据集可以自己构造
- 实验报告格式自由（Jupyter 或 Markdown）

## 对接方式

- 产出提交到：`raphael/research/A1_HDC_encoding/`
- 建议周期：2-3 周
- 后续依赖：H5（超向量可视化）需要 A1 的编码函数
