asyncapi: 2.6.0
info:
  title: Requirement Network Mod Events
  version: 1.0.0
  description: |
    Event definitions for the requirement_network mod.

    This mod enables a requirement-driven workflow with:
    - User agents submitting requirements in natural language
    - Automatic channel creation for each requirement
    - Agent registry with admin-only access
    - Admin agent invitation of relevant agents
    - Coordinator task distribution and response handling

channels:
  requirement_network.requirement.submit:
    description: Submit a new requirement in natural language
    publish:
      operationId: submitRequirement
      message:
        payload:
          type: object
          properties:
            requirement_text:
              type: string
              description: The requirement description in natural language
            metadata:
              type: object
              description: Optional metadata (priority, deadline, tags)
              properties:
                priority:
                  type: string
                  enum: [low, medium, high]
                deadline:
                  type: string
                tags:
                  type: array
                  items:
                    type: string
          required:
            - requirement_text

  requirement_network.channel_created:
    description: Notification that a requirement channel was created
    subscribe:
      operationId: onChannelCreated
      message:
        payload:
          type: object
          properties:
            channel_id:
              type: string
            requirement_id:
              type: string
            requirement_text:
              type: string
            creator_id:
              type: string
            metadata:
              type: object
            created_timestamp:
              type: number

  requirement_network.registry.register:
    description: Register agent capabilities with the network
    publish:
      operationId: registerCapabilities
      message:
        payload:
          type: object
          properties:
            capabilities:
              type: object
              description: Agent capabilities (skills, specialties)
              properties:
                skills:
                  type: array
                  items:
                    type: string
                specialties:
                  type: array
                  items:
                    type: string
            agent_card:
              type: object
              description: Full agent profile/card

  requirement_network.registry.read:
    description: Read agent registry (admin-only)
    publish:
      operationId: readRegistry
      message:
        payload:
          type: object
          properties:
            filter:
              type: object
              description: Optional filter criteria
              properties:
                skills:
                  type: array
                  items:
                    type: string

  requirement_network.agent.invite:
    description: Invite agents to a requirement channel
    publish:
      operationId: inviteAgents
      message:
        payload:
          type: object
          properties:
            channel_id:
              type: string
            agent_ids:
              type: array
              items:
                type: string
          required:
            - channel_id
            - agent_ids

  requirement_network.channel.join:
    description: Join a requirement channel
    publish:
      operationId: joinChannel
      message:
        payload:
          type: object
          properties:
            channel_id:
              type: string
          required:
            - channel_id

  requirement_network.invitations.complete:
    description: Signal that all invitations are complete
    publish:
      operationId: signalInvitationsComplete
      message:
        payload:
          type: object
          properties:
            channel_id:
              type: string
          required:
            - channel_id

  requirement_network.invitations_complete:
    description: Notification that all invitations are complete for a channel
    subscribe:
      operationId: onInvitationsComplete
      message:
        payload:
          type: object
          properties:
            channel_id:
              type: string
            requirement_id:
              type: string
            requirement_text:
              type: string
            invited_agents:
              type: array
              items:
                type: string

  requirement_network.task.distribute:
    description: Distribute a task to an agent
    publish:
      operationId: distributeTask
      message:
        payload:
          type: object
          properties:
            channel_id:
              type: string
            agent_id:
              type: string
            task_id:
              type: string
            task:
              type: object
              properties:
                description:
                  type: string
          required:
            - channel_id
            - agent_id
            - task

  requirement_network.task.respond:
    description: Respond to a distributed task
    publish:
      operationId: respondToTask
      message:
        payload:
          type: object
          properties:
            channel_id:
              type: string
            task_id:
              type: string
            response_type:
              type: string
              enum: [accept, reject, propose]
            content:
              type: object
              properties:
                message:
                  type: string
                reason:
                  type: string
                alternative:
                  type: string
          required:
            - channel_id
            - task_id
            - response_type

  requirement_network.notification.agent_invited:
    description: Notification that an agent was invited to a channel
    subscribe:
      operationId: onAgentInvited
      message:
        payload:
          type: object
          properties:
            channel_id:
              type: string
            requirement_id:
              type: string
            requirement_text:
              type: string
            invited_by:
              type: string

  requirement_network.notification.task_distributed:
    description: Notification that a task was distributed to an agent
    subscribe:
      operationId: onTaskDistributed
      message:
        payload:
          type: object
          properties:
            channel_id:
              type: string
            task_id:
              type: string
            task:
              type: object
            distributed_by:
              type: string

  requirement_network.notification.task_response:
    description: Notification that an agent responded to a task
    subscribe:
      operationId: onTaskResponse
      message:
        payload:
          type: object
          properties:
            channel_id:
              type: string
            task_id:
              type: string
            agent_id:
              type: string
            response_type:
              type: string
              enum: [accept, reject, propose]
            content:
              type: object

  requirement_network.notification.user_update:
    description: Notification update for the user who submitted the requirement
    subscribe:
      operationId: onUserUpdate
      message:
        payload:
          type: object
          properties:
            channel_id:
              type: string
            update_type:
              type: string
              enum: [task_accepted, task_rejected, task_proposed, channel_complete]
            agent_id:
              type: string
            task_id:
              type: string
            content:
              type: object

  requirement_network.channel.get_info:
    description: Get information about a requirement channel
    publish:
      operationId: getChannelInfo
      message:
        payload:
          type: object
          properties:
            channel_id:
              type: string
          required:
            - channel_id
